<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tokenizer Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0d1117;
            --bg-card: #161b22;
            --bg-input: #0d1117;
            --border: #30363d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --accent-cyan: #58d5e3;
            --accent-purple: #a78bfa;
            --accent-green: #4ade80;
            --accent-orange: #fb923c;
            --accent-pink: #f472b6;
            --accent-blue: #60a5fa;
            --accent-yellow: #facc15;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .tokenizer-widget {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            padding: 2rem;
            border-radius: 16px;
            max-width: 900px;
            margin: 0 auto;
            border: 1px solid var(--border);
        }

        .widget-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .widget-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .widget-title {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .widget-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }

        .input-section {
            margin-bottom: 1.5rem;
        }

        .input-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .text-input {
            width: 100%;
            padding: 1rem 1.25rem;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            resize: vertical;
            min-height: 80px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 4px rgba(88, 213, 227, 0.15);
        }

        .text-input::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        .stats-bar {
            display: flex;
            gap: 1.5rem;
            padding: 1rem 1.25rem;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-cyan);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }

        .output-section {
            margin-bottom: 1.5rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .section-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .token-display {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 1.25rem;
            background: var(--bg-card);
            border-radius: 12px;
            min-height: 60px;
            border: 1px solid var(--border);
        }

        .token-chip {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            cursor: pointer;
            transition: transform 0.15s, box-shadow 0.15s;
            animation: tokenAppear 0.3s ease-out backwards;
        }

        .token-chip:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .token-text {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .token-id {
            font-size: 0.7rem;
            opacity: 0.7;
        }

        @keyframes tokenAppear {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .token-list {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            padding: 1rem 1.25rem;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border);
            color: var(--accent-green);
            word-break: break-all;
        }

        .info-box {
            padding: 1rem 1.25rem;
            background: rgba(88, 213, 227, 0.08);
            border-left: 3px solid var(--accent-cyan);
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .info-box strong {
            color: var(--accent-cyan);
        }

        .preset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .preset-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-family: 'DM Sans', sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            background: var(--border);
            color: var(--text-primary);
            border-color: var(--accent-cyan);
        }

        .special-char {
            background: rgba(167, 139, 250, 0.2);
            color: var(--accent-purple);
            padding: 0 0.25rem;
            border-radius: 3px;
            font-size: 0.75rem;
        }

        .empty-state {
            color: var(--text-secondary);
            font-style: italic;
            padding: 1rem;
            text-align: center;
        }

        /* Token color palette */
        .token-0 { background: rgba(88, 213, 227, 0.2); color: var(--accent-cyan); }
        .token-1 { background: rgba(167, 139, 250, 0.2); color: var(--accent-purple); }
        .token-2 { background: rgba(74, 222, 128, 0.2); color: var(--accent-green); }
        .token-3 { background: rgba(251, 146, 60, 0.2); color: var(--accent-orange); }
        .token-4 { background: rgba(244, 114, 182, 0.2); color: var(--accent-pink); }
        .token-5 { background: rgba(96, 165, 250, 0.2); color: var(--accent-blue); }
        .token-6 { background: rgba(250, 204, 21, 0.2); color: var(--accent-yellow); }
    </style>
</head>
<body>
    <div class="tokenizer-widget">
        <div class="widget-header">
            <div class="widget-icon">üî§</div>
            <div>
                <h2 class="widget-title">Tokenizer Explorer</h2>
                <p class="widget-subtitle">Entdecke, wie LLMs Text in Tokens zerlegen</p>
            </div>
        </div>

        <div class="input-section">
            <label class="input-label" for="textInput">Eingabetext</label>
            <textarea 
                id="textInput" 
                class="text-input" 
                placeholder="Gib hier einen Text ein, um zu sehen, wie er tokenisiert wird..."
            >The quick brown fox jumps over the lazy dog.</textarea>
            
            <div class="preset-buttons">
                <button class="preset-btn" onclick="setPreset('english')">Englisch</button>
                <button class="preset-btn" onclick="setPreset('german')">Deutsch</button>
                <button class="preset-btn" onclick="setPreset('code')">Python Code</button>
                <button class="preset-btn" onclick="setPreset('emoji')">Mit Emoji üéâ</button>
                <button class="preset-btn" onclick="setPreset('numbers')">Zahlen</button>
            </div>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-value" id="tokenCount">0</span>
                <span class="stat-label">Tokens</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="charCount">0</span>
                <span class="stat-label">Zeichen</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="ratio">0.0</span>
                <span class="stat-label">Zeichen/Token</span>
            </div>
        </div>

        <div class="output-section">
            <div class="section-header">
                <span class="section-title">Visualisierung der Tokens</span>
            </div>
            <div class="token-display" id="tokenDisplay">
                <span class="empty-state">Gib Text ein, um Tokens zu sehen</span>
            </div>
        </div>

        <div class="output-section">
            <div class="section-header">
                <span class="section-title">Token-IDs (wie vom Modell gesehen)</span>
            </div>
            <div class="token-list" id="tokenList">[]</div>
        </div>

        <div class="info-box">
            <strong>üí° Wusstest du?</strong> LLMs sehen Text nicht als Buchstaben, sondern als Tokens ‚Äì 
            kleine Textbausteine mit eindeutigen IDs. Ein Token kann ein Wort, ein Wortteil oder sogar 
            nur ein Zeichen sein. Leerzeichen werden oft mit dem folgenden Wort kombiniert 
            (wie <span class="special-char">‚ê£quick</span>). Die Tokenisierung beeinflusst direkt 
            Kosten und Kontextl√§nge bei API-Aufrufen.
        </div>
    </div>

    <script>
        // Simulated GPT-2 style tokenizer (simplified demonstration)
        // In reality, you'd use a proper tokenizer library
        const simulatedVocab = {
            'The': 464,
            ' quick': 2068,
            ' brown': 7586,
            ' fox': 21831,
            ' jumps': 18045,
            ' over': 625,
            ' the': 262,
            ' lazy': 16931,
            ' dog': 3290,
            '.': 13,
            ',': 11,
            '!': 0,
            '?': 30,
            ' ': 220,
            '\n': 198,
            'Hello': 15496,
            ' World': 2159,
            ' AI': 9552,
            ' is': 318,
            ' amazing': 4998,
            'def': 4299,
            ' print': 3601,
            '(': 7,
            ')': 8,
            ':': 25,
            '"': 1,
            "'": 6,
            ' Hello': 18435,
            ' world': 995,
            '1': 16,
            '2': 17,
            '3': 18,
            '4': 19,
            '5': 20,
            '0': 15,
            ' ': 220,
            'a': 64,
            'b': 65,
            'c': 66,
            'd': 67,
            'e': 68,
            'f': 69,
            'g': 70,
            'h': 71,
            'i': 72,
            'j': 73,
            'k': 74,
            'l': 75,
            'm': 76,
            'n': 77,
            'o': 78,
            'p': 79,
            'q': 80,
            'r': 81,
            's': 82,
            't': 83,
            'u': 84,
            'v': 85,
            'w': 86,
            'x': 87,
            'y': 88,
            'z': 89,
            'A': 32,
            'B': 33,
            'C': 34,
            'D': 35,
            'E': 36,
            'F': 37,
            'G': 38,
            'H': 39,
            'I': 40,
            'J': 41,
            'K': 42,
            'L': 43,
            'M': 44,
            'N': 45,
            'O': 46,
            'P': 47,
            'Q': 48,
            'R': 49,
            'S': 50,
            'T': 51,
            'U': 52,
            'V': 53,
            'W': 54,
            'X': 55,
            'Y': 56,
            'Z': 57,
            // German words
            ' und': 3384,
            ' der': 2853,
            ' die': 2876,
            ' das': 2896,
            ' ist': 1556,
            ' ein': 2003,
            ' eine': 2004,
            'Hallo': 34710,
            ' Welt': 40283,
            ' schnelle': 34892,
            ' braune': 40125,
            ' Fuchs': 37483,
            ' springt': 41029,
            '√º': 252,
            '√§': 228,
            '√∂': 246,
            '√ü': 223,
            ' √ºber': 38751,
            ' den': 2853,
            ' faulen': 43891,
            ' Hund': 39756,
            // Code tokens
            'import': 11748,
            ' tiktoken': 46668,
            'encoding': 12685,
            ' =': 796,
            ' encoding': 21004,
            '_for': 62,
            '_model': 19849,
            'gpt': 70,
            '-': 12,
            // Emoji (simplified - real tokenizers handle these differently)
            'üéâ': 8582,
            'üöÄ': 9145,
            '‚ù§': 10084,
            'Ô∏è': 65039,
            'üòÄ': 128512,
            'ü§ñ': 129302,
            '‚ú®': 10024,
        };

        // Simple tokenization function (demonstration purposes)
        function tokenize(text) {
            const tokens = [];
            let remaining = text;
            
            while (remaining.length > 0) {
                let found = false;
                
                // Try to find the longest matching token
                for (let len = Math.min(remaining.length, 10); len > 0; len--) {
                    const candidate = remaining.substring(0, len);
                    if (simulatedVocab.hasOwnProperty(candidate)) {
                        tokens.push({
                            text: candidate,
                            id: simulatedVocab[candidate]
                        });
                        remaining = remaining.substring(len);
                        found = true;
                        break;
                    }
                }
                
                // If no match found, treat single character as unknown token
                if (!found) {
                    const char = remaining[0];
                    const charCode = char.charCodeAt(0);
                    tokens.push({
                        text: char,
                        id: 50000 + charCode // Simulated byte-level fallback
                    });
                    remaining = remaining.substring(1);
                }
            }
            
            return tokens;
        }

        function formatTokenText(text) {
            // Make whitespace visible
            return text
                .replace(/^ /, '‚ê£')
                .replace(/\n/g, '‚Üµ')
                .replace(/\t/g, '‚Üí');
        }

        function updateDisplay() {
            const input = document.getElementById('textInput').value;
            const tokenDisplay = document.getElementById('tokenDisplay');
            const tokenList = document.getElementById('tokenList');
            const tokenCount = document.getElementById('tokenCount');
            const charCount = document.getElementById('charCount');
            const ratio = document.getElementById('ratio');

            if (!input) {
                tokenDisplay.innerHTML = '<span class="empty-state">Gib Text ein, um Tokens zu sehen</span>';
                tokenList.textContent = '[]';
                tokenCount.textContent = '0';
                charCount.textContent = '0';
                ratio.textContent = '0.0';
                return;
            }

            const tokens = tokenize(input);
            
            // Update stats
            tokenCount.textContent = tokens.length;
            charCount.textContent = input.length;
            ratio.textContent = (input.length / tokens.length).toFixed(1);

            // Create token chips
            tokenDisplay.innerHTML = tokens.map((token, index) => {
                const colorClass = `token-${index % 7}`;
                const displayText = formatTokenText(token.text);
                const delay = index * 0.03;
                return `
                    <div class="token-chip ${colorClass}" 
                         style="animation-delay: ${delay}s"
                         title="Token: '${token.text.replace(/'/g, "\\'")}' ‚Üí ID: ${token.id}">
                        <span class="token-text">${escapeHtml(displayText)}</span>
                        <span class="token-id">${token.id}</span>
                    </div>
                `;
            }).join('');

            // Update token ID list
            tokenList.textContent = '[' + tokens.map(t => t.id).join(', ') + ']';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function setPreset(type) {
            const presets = {
                english: 'The quick brown fox jumps over the lazy dog.',
                german: 'Der schnelle braune Fuchs springt √ºber den faulen Hund.',
                code: 'def hello():\n    print("Hello world")',
                emoji: 'AI is amazing! üöÄ‚ú®ü§ñ',
                numbers: '12345 + 67890 = 80235'
            };
            
            document.getElementById('textInput').value = presets[type] || '';
            updateDisplay();
        }

        // Initialize
        document.getElementById('textInput').addEventListener('input', updateDisplay);
        updateDisplay();
    </script>
</body>
</html>
